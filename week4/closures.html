<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
		<title>Closures and Event Handling</title>
        
        <script>
            
            function MyClass(msg) {
                
                this.message = msg;
                
                this.handleButtonClick = function() {
                    console.log("MyClass handleButtonClick this:", this);
                    alert(this.message);
                }
                
                //Define a new variable to hold this because if this method
                //is used as an event handler 'this' will point to the button,
                //not the current instance
                var me = this;
                this.handleButtonClickThree = function() {
                    alert(me.message);
                }
            }
            
            function go() {
                
                console.log('test');
                var myInstance = new MyClass('You clicked the button!');
                
                //This won't work because the 'this' keyword will refer to the button
                //rather than myInstance
                var myBtn = document.getElementById('myButton');
                myBtn.onclick = myInstance.handleButtonClick;           
                
                //Use an anonymous function
                var myBtnToo = document.getElementById('myButtonToo');
                myBtnToo.onclick = function () {
                    console.log("anonymous function this:", this);
                    myInstance.handleButtonClick();
                }
                
                //Use the handler that has defined a new variable to hold this
                var myBtnThree = document.getElementById('myButtonThree');
                myBtnThree.onclick = myInstance.handleButtonClickThree;
            }
        </script>
        
	</head>
	<body onload="go();">
	    <button id="myButton">Click Me!</button>
        <button id="myButtonToo">Click Me Too!</button>
        <button id="myButtonThree">Click Me Three!</button>
	</body>
</html>
